<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.14.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ä¸»è¦å†™ä¸€äº›ç»ƒä¹ kaggleçš„å¿ƒå¾—å’Œæµç¨‹ï¼Œä¸»è¦å‚è€ƒKaggle å…¥é—¨æŒ‡å— - çŸ¥ä¹ (zhihu.com) ç°åœ¨å‘ç°Introduction | Kaggleä¹Ÿå†™å¾—å¾ˆå¥½ï¼Œèµ·ç å®Œæ•´æµç¨‹æ˜¯æœ‰çš„ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="kaggle">
<meta property="og:url" content="http://example.com/2023/01/03/kaggle/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="ä¸»è¦å†™ä¸€äº›ç»ƒä¹ kaggleçš„å¿ƒå¾—å’Œæµç¨‹ï¼Œä¸»è¦å‚è€ƒKaggle å…¥é—¨æŒ‡å— - çŸ¥ä¹ (zhihu.com) ç°åœ¨å‘ç°Introduction | Kaggleä¹Ÿå†™å¾—å¾ˆå¥½ï¼Œèµ·ç å®Œæ•´æµç¨‹æ˜¯æœ‰çš„ã€‚">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-01-03T06:56:30.000Z">
<meta property="article:modified_time" content="2023-06-03T12:28:25.120Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="kaggle">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2023/01/03/kaggle/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2023/01/03/kaggle/","path":"2023/01/03/kaggle/","title":"kaggle"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>kaggle | Hexo</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#kaggle-%E6%AF%94%E8%B5%9B%E6%B5%81%E7%A8%8B"><span class="nav-number">1.</span> <span class="nav-text">kaggle æ¯”èµ›æµç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Exploratory-Data-Analysis"><span class="nav-number">1.1.</span> <span class="nav-text">Exploratory Data Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="nav-number">1.1.1.</span> <span class="nav-text">å¯è§†åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1%E6%A3%80%E9%AA%8C"><span class="nav-number">1.1.2.</span> <span class="nav-text">ç»Ÿè®¡æ£€éªŒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%EF%BC%88%E5%8F%82%E8%80%83kaggle%E8%AF%BE%E7%A8%8BLearn-Data-Cleaning-Tutorials-kaggle-com-%EF%BC%89%EF%BC%88%E8%BF%99%E9%83%A8%E5%88%86%E5%9C%A8%E5%AE%9E%E9%99%85%E4%B8%AD%E7%94%A8%E5%88%B0%E4%BA%86%E5%8D%B3%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E7%99%BE%E5%BA%A6%E7%A8%8B%E5%BA%8F%E6%88%96%E8%80%85%E7%BF%BBKaggle%E8%AF%BE%E7%A8%8B%E9%87%8C%E9%9D%A2%E4%BB%A3%E7%A0%81%EF%BC%89"><span class="nav-number">1.1.3.</span> <span class="nav-text">æ•°æ®æ¸…æ´—ï¼ˆå‚è€ƒkaggleè¯¾ç¨‹Learn Data Cleaning Tutorials (kaggle.com)ï¼‰ï¼ˆè¿™éƒ¨åˆ†åœ¨å®é™…ä¸­ç”¨åˆ°äº†å³å¯ä»¥ç›´æ¥ç™¾åº¦ç¨‹åºæˆ–è€…ç¿»Kaggleè¯¾ç¨‹é‡Œé¢ä»£ç ï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="nav-number">1.1.4.</span> <span class="nav-text">æ•°æ®é¢„å¤„ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">ç¼ºå¤±å€¼å¤„ç†</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B%EF%BC%88%E5%8F%82%E8%80%83Learn-Feature-Engineering-Tutorials-kaggle-com-%EF%BC%89"><span class="nav-number">1.2.</span> <span class="nav-text">ç‰¹å¾å·¥ç¨‹ï¼ˆå‚è€ƒLearn Feature Engineering Tutorials (kaggle.com)ï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B"><span class="nav-number">1.2.0.1.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯ç‰¹å¾å·¥ç¨‹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E6%95%88%E7%94%A8%E6%8C%87%E6%A0%87"><span class="nav-number">1.2.1.</span> <span class="nav-text">ç‰¹å¾æ•ˆç”¨æŒ‡æ ‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%91%E7%8E%B0%E6%96%B0%E7%9A%84%E7%89%B9%E5%BE%81"><span class="nav-number">1.2.2.</span> <span class="nav-text">å‘ç°æ–°çš„ç‰¹å¾</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Mathematical-Transforms%EF%BC%9A%E5%AF%B9%E7%89%B9%E5%BE%81%E8%BF%9B%E8%A1%8C%E7%AE%80%E5%8D%95%E7%9A%84%E5%8A%A0%E5%87%8F%E4%B9%98%E9%99%A4%E7%BB%84%E5%90%88%EF%BC%8C%E4%B8%80%E8%88%AC%E6%9D%A5%E8%AF%B4%E9%80%9A%E8%BF%87%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E6%9D%A5%E8%B0%83%E6%95%B4%E7%BB%84%E5%90%88"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">Mathematical Transformsï¼šå¯¹ç‰¹å¾è¿›è¡Œç®€å•çš„åŠ å‡ä¹˜é™¤ç»„åˆï¼Œä¸€èˆ¬æ¥è¯´é€šè¿‡æ•°æ®å¯è§†åŒ–æ¥è°ƒæ•´ç»„åˆ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Counts-Features-describing-the-presence-or-absence-of-something-often-come-in-sets-the-set-of-risk-factors-for-a-disease-say-You-can-aggregate-such-features-by-creating-a-count"><span class="nav-number">1.2.3.</span> <span class="nav-text">Counts: Features describing the presence or absence of something often come in sets, the set of risk factors for a disease, say. You can aggregate such features by creating a count.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Building-Up-and-Breaking-Down-Features-%E6%AF%94%E5%A6%82%E8%BA%AB%E4%BB%BD%E8%AF%81%E5%89%8D%E5%85%AD%E4%BD%8D%E6%98%AF%E5%9C%B0%E5%9D%80%E4%BB%80%E4%B9%88%E7%9A%84"><span class="nav-number">1.2.4.</span> <span class="nav-text">Building-Up and Breaking-Down Features: æ¯”å¦‚èº«ä»½è¯å‰å…­ä½æ˜¯åœ°å€ä»€ä¹ˆçš„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Group-Transformation-Using-an-aggregation-function-a-group-transform-combines-two-features-a-categorical-feature-that-provides-the-grouping-and-another-feature-whose-values-you-wish-to-aggregate"><span class="nav-number">1.2.5.</span> <span class="nav-text">Group Transformation: Using an aggregation function, a group transform combines two features: a categorical feature that provides the grouping and another feature whose values you wish to aggregate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86%E8%81%9A%E7%B1%BB%E6%A0%87%E7%AD%BE%E4%BD%9C%E4%B8%BA%E7%89%B9%E5%BE%81"><span class="nav-number">1.2.6.</span> <span class="nav-text">å°†èšç±»æ ‡ç­¾ä½œä¸ºç‰¹å¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PCA"><span class="nav-number">1.2.7.</span> <span class="nav-text">PCA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Target-Encoding%EF%BC%88%E9%92%88%E5%AF%B9%E5%88%86%E7%B1%BB%E5%8F%98%E9%87%8F%EF%BC%89"><span class="nav-number">1.2.8.</span> <span class="nav-text">Target Encodingï¼ˆé’ˆå¯¹åˆ†ç±»å˜é‡ï¼‰</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Smoothing"><span class="nav-number">2.</span> <span class="nav-text">Smoothing</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pipeline"><span class="nav-number">2.1.</span> <span class="nav-text">Pipeline</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/01/03/kaggle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="kaggle | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          kaggle
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-01-03 14:56:30" itemprop="dateCreated datePublished" datetime="2023-01-03T14:56:30+08:00">2023-01-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-06-03 20:28:25" itemprop="dateModified" datetime="2023-06-03T20:28:25+08:00">2023-06-03</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>ä¸»è¦å†™ä¸€äº›ç»ƒä¹ kaggleçš„å¿ƒå¾—å’Œæµç¨‹ï¼Œä¸»è¦å‚è€ƒ<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/25742261">Kaggle å…¥é—¨æŒ‡å— - çŸ¥ä¹ (zhihu.com)</a></p>
<p>ç°åœ¨å‘ç°<a target="_blank" rel="noopener" href="https://www.kaggle.com/code/alexisbcook/introduction">Introduction | Kaggle</a>ä¹Ÿå†™å¾—å¾ˆå¥½ï¼Œèµ·ç å®Œæ•´æµç¨‹æ˜¯æœ‰çš„ã€‚</p>
<span id="more"></span>
<p>ä¸€ä¸ªç®€å•çš„ç›®å½•:</p>
<p>æ•°æ®å¤„ç†ï¼š</p>
<p>ç¼ºå¤±å€¼å¤„ç†ï¼š1æ‰”æ‰é‚£äº›æœ‰ç¼ºå¤±å€¼çš„åˆ—2ç®€å•çš„å¡«å……imputation</p>
<p>åˆ†ç±»å˜é‡å¤„ç†ï¼š1ordinal encoding 2 onehot encoding</p>
<p>ç‰¹å¾ç­›é€‰ï¼š</p>
<p>æ¨¡å‹é€‰æ‹©ï¼šrandom forestï¼ŒXGBoost</p>
<p>pipeline:</p>
<p>äº¤å‰éªŒè¯ï¼š</p>
<h1 id="kaggle-æ¯”èµ›æµç¨‹"><a href="#kaggle-æ¯”èµ›æµç¨‹" class="headerlink" title="kaggle æ¯”èµ›æµç¨‹"></a>kaggle æ¯”èµ›æµç¨‹</h1><h2 id="Exploratory-Data-Analysis"><a href="#Exploratory-Data-Analysis" class="headerlink" title="Exploratory Data Analysis"></a><strong>Exploratory Data Analysis</strong></h2><p>å¸¸ç”¨çš„åº“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> warnings <span class="comment"># current version of seaborn generates a bunch of warnings that we&#x27;ll ignore</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">sns.<span class="built_in">set</span>(style=<span class="string">&quot;white&quot;</span>, color_codes=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#è§£å†³è¡Œåˆ—æ˜¾ç¤ºä¸å…¨</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_rows&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"><span class="keyword">from</span> sklearn.impute <span class="keyword">import</span> SimpleImputer</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹æ•°æ®æƒ…å†µ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŒ…å«åºå·ï¼Œåˆ—åï¼Œnon-nullï¼ŒDtype</span></span><br><span class="line">df.info()</span><br><span class="line"><span class="comment">#åŒ…å«mean,std,min,max,åˆ†ä½æ•°</span></span><br><span class="line">df.describe()</span><br><span class="line"><span class="comment">#å‰5ä¸ªæ•°æ®</span></span><br><span class="line">df.head()</span><br><span class="line"><span class="comment">#åç»¼åˆçš„ï¼Œæ¯”infoå¤šä¸€ä¸ªunique value,missing value,ç¼ºå¤±å€¼æ˜¯nanï¼Œç©ºå€¼æ˜¯nullï¼Œè¶…çº§å…¨é¢ï¼Œä½†æ˜¯ç‰¹å¾å¤ªå¤šå¯èƒ½æ˜¾ç¤ºå¾ˆç´¯</span></span><br><span class="line"><span class="comment">#å¯ä»¥è€ƒè™‘æ‹†å¼€ç”¨</span></span><br><span class="line"><span class="comment">#æ€ä¹ˆæ„Ÿè§‰non-null+missingæ­£å¥½æ˜¯æ•°æ®æ€»æ•°å‘¢</span></span><br><span class="line"><span class="comment">#unique valueå¾ˆå¤šçš„æ—¶å€™æ…ç”¨ï¼Œå†…å®¹å¤ªå¤šäº†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_column_details</span>(<span class="params">df</span>):</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> df.columns:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Column name: <span class="subst">&#123;col&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Column data type: <span class="subst">&#123;df[col].dtype&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Number of non-null values: <span class="subst">&#123;df[col].count()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Number of unique values: <span class="subst">&#123;df[col].nunique()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Number of count of per unique value: <span class="subst">&#123;df[col].value_counts()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Number of missing values: <span class="subst">&#123;df[col].isnull().<span class="built_in">sum</span>()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">print_column_details(train)        </span><br></pre></td></tr></table></figure>
<h3 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h3><p>æ•£ç‚¹å›¾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é’ˆå¯¹ç¦»æ•£å˜é‡</span></span><br><span class="line">sns.countplot(data = df, x = <span class="string">&quot;col&quot;</span>);</span><br><span class="line"><span class="comment"># A seaborn jointplot shows bivariate scatterplots and univariate histograms in the same figure</span></span><br><span class="line">sns.jointplot(x=<span class="string">&quot;col1&quot;</span>, y=<span class="string">&quot;col2&quot;</span>, data=df, size=<span class="number">5</span>)</span><br><span class="line"><span class="comment">#ä¸‰å˜é‡æ•£ç‚¹å›¾</span></span><br><span class="line"><span class="comment">#hueå°±æ˜¯é’ˆå¯¹æŸä¸€å˜é‡è¿›è¡Œåˆ†ç±»</span></span><br><span class="line">sns.FacetGrid(df, hue=<span class="string">&quot;col1&quot;</span>, size=<span class="number">5</span>) \</span><br><span class="line">   .<span class="built_in">map</span>(plt.scatter, <span class="string">&quot;col2&quot;</span>, <span class="string">&quot;col3&quot;</span>) \</span><br><span class="line">   .add_legend()</span><br></pre></td></tr></table></figure>
<p>ç®±å‹å›¾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ™®é€šç‰ˆ</span></span><br><span class="line">sns.boxplot(x=<span class="string">&quot;col1&quot;</span>, y=<span class="string">&quot;col2&quot;</span>, data=df)</span><br><span class="line"><span class="comment">#è¿›é˜¶ç‰ˆ</span></span><br><span class="line">ax = sns.boxplot(x=<span class="string">&quot;col1&quot;</span>, y=<span class="string">&quot;col2&quot;</span>, data=df)</span><br><span class="line">ax = sns.stripplot(x=<span class="string">&quot;col1&quot;</span>, y=<span class="string">&quot;col2&quot;</span>, data=df, jitter=<span class="literal">True</span>, edgecolor=<span class="string">&quot;gray&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æ ¸å¯†åº¦å›¾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å•å˜é‡çš„</span></span><br><span class="line">sns.kdeplot(data = df, x = <span class="string">&quot;col&quot;</span>,fill = <span class="literal">True</span>, label = <span class="string">&quot;col&quot;</span>)</span><br><span class="line">sns.distplot(df[<span class="string">&quot;col&quot;</span>])</span><br><span class="line"><span class="comment">#kdeå°±æ˜¯æ ¸å¯†åº¦ï¼Œsizeä½œç”¨æš‚æ—¶æ²¡æ‰¾åˆ°</span></span><br><span class="line">sns.FacetGrid(df, hue=<span class="string">&quot;col1&quot;</span>, size=<span class="number">6</span>) \</span><br><span class="line">   .<span class="built_in">map</span>(sns.kdeplot, <span class="string">&quot;col2&quot;</span>) \</span><br><span class="line">   .add_legend()</span><br></pre></td></tr></table></figure>
<p>å¤§æ‚çƒ©</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ‰€æœ‰ç‰¹å¾æ•£ç‚¹å›¾</span></span><br><span class="line">sns.pairplot(df.drop(<span class="string">&quot;Id&quot;</span>, axis=<span class="number">1</span>), hue=<span class="string">&quot;col&quot;</span>, size=<span class="number">3</span>)</span><br><span class="line"><span class="comment">#é€‰æ‹©å¯¹è§’å›¾çš„ç±»å‹</span></span><br><span class="line">sns.pairplot(df.drop(<span class="string">&quot;Id&quot;</span>, axis=<span class="number">1</span>), hue=<span class="string">&quot;col&quot;</span>, size=<span class="number">3</span>, diag_kind=<span class="string">&quot;kde&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>å…¶ä»–ï¼ˆä¸€äº›å¾ˆç‚«é…·çš„å›¾ï¼‰ä¹Ÿæ˜¯é’ˆå¯¹æ‰€æœ‰ç‰¹å¾ï¼Œæ‰€ä»¥ç‰¹å¾å¤šäº†å¯èƒ½æ•ˆæœä¼šå¾ˆç³Ÿç³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Parallel coordinates plots each feature on a separate column &amp; then draws lines</span></span><br><span class="line"><span class="comment"># connecting the features for each data sample</span></span><br><span class="line"><span class="keyword">from</span> pandas.tools.plotting <span class="keyword">import</span> parallel_coordinates</span><br><span class="line">parallel_coordinates(df.drop(<span class="string">&quot;Id&quot;</span>, axis=<span class="number">1</span>), <span class="string">&quot;col&quot;</span>)</span><br><span class="line"><span class="comment"># Andrews Curves involve using attributes of samples as coefficients for Fourier series</span></span><br><span class="line"><span class="keyword">from</span> pandas.tools.plotting <span class="keyword">import</span> andrews_curves</span><br><span class="line">andrews_curves(df.drop(<span class="string">&quot;Id&quot;</span>, axis=<span class="number">1</span>), <span class="string">&quot;col&quot;</span>)</span><br><span class="line"><span class="comment">#éƒ½å¼€å§‹ä¸å¤ªå¥½ç†è§£äº†</span></span><br><span class="line"><span class="keyword">from</span> pandas.tools.plotting <span class="keyword">import</span> radviz</span><br><span class="line">radviz(df.drop(<span class="string">&quot;Id&quot;</span>, axis=<span class="number">1</span>), <span class="string">&quot;col&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ç»Ÿè®¡æ£€éªŒ"><a href="#ç»Ÿè®¡æ£€éªŒ" class="headerlink" title="ç»Ÿè®¡æ£€éªŒ"></a>ç»Ÿè®¡æ£€éªŒ</h3><h3 id="æ•°æ®æ¸…æ´—ï¼ˆå‚è€ƒkaggleè¯¾ç¨‹Learn-Data-Cleaning-Tutorials-kaggle-com-ï¼‰ï¼ˆè¿™éƒ¨åˆ†åœ¨å®é™…ä¸­ç”¨åˆ°äº†å³å¯ä»¥ç›´æ¥ç™¾åº¦ç¨‹åºæˆ–è€…ç¿»Kaggleè¯¾ç¨‹é‡Œé¢ä»£ç ï¼‰"><a href="#æ•°æ®æ¸…æ´—ï¼ˆå‚è€ƒkaggleè¯¾ç¨‹Learn-Data-Cleaning-Tutorials-kaggle-com-ï¼‰ï¼ˆè¿™éƒ¨åˆ†åœ¨å®é™…ä¸­ç”¨åˆ°äº†å³å¯ä»¥ç›´æ¥ç™¾åº¦ç¨‹åºæˆ–è€…ç¿»Kaggleè¯¾ç¨‹é‡Œé¢ä»£ç ï¼‰" class="headerlink" title="æ•°æ®æ¸…æ´—ï¼ˆå‚è€ƒkaggleè¯¾ç¨‹Learn Data Cleaning Tutorials (kaggle.com)ï¼‰ï¼ˆè¿™éƒ¨åˆ†åœ¨å®é™…ä¸­ç”¨åˆ°äº†å³å¯ä»¥ç›´æ¥ç™¾åº¦ç¨‹åºæˆ–è€…ç¿»Kaggleè¯¾ç¨‹é‡Œé¢ä»£ç ï¼‰"></a>æ•°æ®æ¸…æ´—ï¼ˆå‚è€ƒkaggleè¯¾ç¨‹<a target="_blank" rel="noopener" href="https://www.kaggle.com/learn/data-cleaning">Learn Data Cleaning Tutorials (kaggle.com)</a>ï¼‰ï¼ˆè¿™éƒ¨åˆ†åœ¨å®é™…ä¸­ç”¨åˆ°äº†å³å¯ä»¥ç›´æ¥ç™¾åº¦ç¨‹åºæˆ–è€…ç¿»Kaggleè¯¾ç¨‹é‡Œé¢ä»£ç ï¼‰</h3><p>ç¼ºå¤±å€¼å¤„ç†</p>
<p>é¢å¯¹ç¼ºå¤±å€¼æˆ‘ä»¬é¦–å…ˆè¦åšå‡ºåˆ¤æ–­ï¼š<strong>Is this value missing because it wasnâ€™t recorded or because it doesnâ€™t exist?</strong>å‰è€…æ¯”å¦‚ç¬¬ä¸€ä¸ªç‰¹å¾æ˜¯æœ‰æ— æˆ¿å­ï¼Œç¬¬äºŒä¸ªç‰¹å¾æ˜¯æˆ¿å­å°ºå¯¸ï¼Œæ˜¾ç„¶æ— æˆ¿å­çš„æƒ…å†µä¸‹ç¬¬äºŒä¸ªç‰¹å¾å¿…ç„¶æ˜¯missing value;å¦ä¸€æ–¹é¢åˆ™æ˜¯æˆ‘ä»¬å¸¸è§„æ„ä¹‰ä¸Šçš„ç¼ºå¤±ï¼Œä¸€èˆ¬é€šè¿‡æ’å€¼æ¥å¤„ç†ã€‚</p>
<p>å½“ç„¶è¦æŠŠè¿™äº›åšçš„å¾ˆå®Œæ•´å½“ç„¶æ—¶é—´å¾ˆèŠ±åŠ›æ°”çš„äº‹ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŠŠé‚£äº›å…·æœ‰NaNçš„åˆ—éƒ½åˆ é™¤æ‰ï¼Œå½“ç„¶è¿™è‚¯å®šä¼šæŸå¤±ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼Œç¨å¾®å¥½ä¸€ç‚¹çš„æ–¹æ³•å°±æ˜¯ç”¨<strong>fillna</strong>ï¼Œå…·ä½“æ–¹æ³•å¯ä»¥å‚ç…§å‡½æ•°æœ¬èº«çš„å†…å®¹ã€‚</p>
<p>Scaling and Normalization</p>
<ul>
<li>in <strong>scaling</strong>, youâ€™re changing the <em>range</em> of your data, while</li>
<li>in <strong>normalization</strong>, youâ€™re changing the <em>shape of the distribution</em> of your data.</li>
<li>å‰è€…ä¸»è¦åº”ç”¨äºSVMï¼ŒKNNç­‰ï¼ˆè·ç¦»ç»´åº¦ä¸åŒä¼šå¸¦æ¥å¾ˆå¤§çš„å·®å¼‚ï¼‰ï¼Œåè€…å°±æ˜¯æŠŠæ•°æ®åˆ†å¸ƒå˜æˆæ­£æ€åˆ†å¸ƒï¼Œä¸€èˆ¬é‡‡ç”¨çš„æ–¹æ³•æ˜¯Box-Coxå˜æ¢ï¼Œé€‚ç”¨äºé‚£äº›å¯¹æ•°æ®è¦æ±‚æ˜¯æ­£æ€åˆ†å¸ƒçš„æ¨¡å‹ã€‚</li>
</ul>
<p>å¯¹æ—¥æœŸçš„å¤„ç†</p>
<p>ä¸€èˆ¬DataFrameè¿™ç§å˜é‡ç±»å‹éƒ½æ˜¯Objectï¼Œä½“ç°ä¸å‡ºä»€ä¹ˆä¿¡æ¯ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡å‡½æ•°pd.to_datetimeæ¥è½¬æ¢ï¼Œä½¿å…¶å˜æˆæœ‰æ•ˆçš„ç‰¹å¾ã€‚</p>
<p>å¯¹æ•°æ®è¾“å…¥ä¸ä¸€è‡´çš„å¤„ç†</p>
<p>ç®€å•çš„è¯´å°±æ˜¯è¾“å…¥çš„æ•°æ®å¯èƒ½æœ¬æ¥æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œä½†æ˜¯ç”±äºå­—æ¯å¤§å°ä¸ä¸€è‡´ï¼Œæˆ–è€…å¤šä¸ªç©ºæ ¼ï¼Œæˆ–è€…ç”±äºè¾“å…¥é—®é¢˜ï¼Œæˆ–è€…è¡¨è¾¾é—®é¢˜ï¼Œ å¯¼è‡´ä¸€ä¸ªå•è¯æœ‰ç›¸ä¼¼çš„è¡¨è¾¾æ–¹æ³•ï¼Œè‡´ç»Ÿè®¡å‡ºæ¥çš„æ•°æ®æ˜¯å¤šä¸ª,æ¯”å¦‚â€Australiaâ€å’Œâ€australiaâ€ã€‚é€šè¿‡è°ƒåŒ…fuzzywuzzyè§£å†³ã€‚</p>
<h3 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a>æ•°æ®é¢„å¤„ç†</h3><p>å¤„ç†missing dataï¼Œoutlierï¼ŒCategorical Variable</p>
<h4 id="ç¼ºå¤±å€¼å¤„ç†"><a href="#ç¼ºå¤±å€¼å¤„ç†" class="headerlink" title="ç¼ºå¤±å€¼å¤„ç†"></a>ç¼ºå¤±å€¼å¤„ç†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¯¹objectæ•°æ®å¡«å……æœ€å¸¸ç”¨çš„(æ„Ÿè§‰ä¼šæ”¹å˜åŸå§‹åˆ†å¸ƒ)ï¼Œå¯¹numericalå¡«å……ä¸­ä½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_missing_values</span>(<span class="params">df</span>):</span><br><span class="line">    <span class="comment"># Check for missing values in each column</span></span><br><span class="line">    missing_values = df.isnull().<span class="built_in">sum</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Fill missing values according to data type</span></span><br><span class="line">    <span class="keyword">for</span> column, num_missing <span class="keyword">in</span> missing_values.items():</span><br><span class="line">        <span class="keyword">if</span> num_missing &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> df[column].dtype == <span class="string">&#x27;object&#x27;</span>:</span><br><span class="line">                <span class="comment"># Fill missing values in categorical columns with the most frequent value</span></span><br><span class="line">                df[column].fillna(df[column].mode()[<span class="number">0</span>], inplace=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># Fill missing values in numerical columns with the median value</span></span><br><span class="line">                df[column].fillna(df[column].median(), inplace=<span class="literal">True</span>)</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line">handle_missing_values(train)</span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æ„Ÿè§‰ä¹Ÿæ˜¯è¾ƒä¸ºå¸¸ç”¨çš„SimpleImputerï¼Œä¸è¿‡æ„Ÿè§‰åšçš„æœ‰ç‚¹è¿‡åˆ†ï¼Œè¿™æ˜¯é’ˆå¯¹numericï¼ŒSimpleImputerå¯ä»¥å‚è€ƒ<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/461017748">æœºå™¨å­¦ä¹ ç‰¹å¾å·¥ç¨‹-ç¼ºå¤±å€¼å¡«å……ï¼šSimpleImputer - çŸ¥ä¹ (zhihu.com)</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">advanced_preprocess_numeric_columns</span>(<span class="params">df, method=<span class="string">&#x27;median&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Takes a Pandas DataFrame and performs advanced preprocessing on all numeric columns that need it.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Fills missing values using SimpleImputer, scales the data using StandardScaler, and removes outliers using the Z-score.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns the modified DataFrame.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Make a copy of the DataFrame to avoid modifying the original data</span></span><br><span class="line">    df = df.copy()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Get a list of all numeric columns</span></span><br><span class="line">    numeric_columns = df.select_dtypes(include=[<span class="string">&#x27;int64&#x27;</span>, <span class="string">&#x27;float64&#x27;</span>]).columns</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Loop through each numeric column</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> numeric_columns:</span><br><span class="line">        <span class="comment"># Check if the column has missing values or outliers</span></span><br><span class="line">        <span class="keyword">if</span> df[col].isnull().<span class="built_in">any</span>() <span class="keyword">or</span> df[col].between(df[col].quantile(<span class="number">.01</span>), df[col].quantile(<span class="number">.99</span>)).<span class="built_in">all</span>():</span><br><span class="line">            <span class="comment"># Fill missing values using SimpleImputer</span></span><br><span class="line">            imputer = SimpleImputer(strategy=method)</span><br><span class="line">            df[col] = imputer.fit_transform(df[col].values.reshape(-<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Scale the data using StandardScaler</span></span><br><span class="line">            scaler = StandardScaler()</span><br><span class="line">            df[col] = scaler.fit_transform(df[col].values.reshape(-<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Remove outliers using the Z-score</span></span><br><span class="line">            z_scores = stats.zscore(df[col])</span><br><span class="line">            df = df[np.<span class="built_in">abs</span>(z_scores) &lt; <span class="number">3</span>]</span><br><span class="line">            </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Advanced preprocessing steps completed for columns that needed it: filled missing values, scaled data, and removed outliers.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> df</span><br></pre></td></tr></table></figure>
<p>è¡¥å……ä¸€äº›missing_valueçš„å¤„ç†æ–¹æ³•ï¼Œçµæ„Ÿæ¥è‡ª<a target="_blank" rel="noopener" href="https://www.kaggle.com/code/kishan9044/story-of-titanic/notebook">Story of ğŸ›³ï¸ Titanic :) | Kaggle</a>(å¼ºçƒˆå®‰åˆ©è¿™ä¸ªï¼ŒçœŸçš„æ˜¯å…¥é—¨æœ€å…¨çš„ä¸œè¥¿ï¼Œæœ€åŸºç¡€çš„Titanicéƒ½æœ‰å¾ˆå¤šä¸œè¥¿å¯ä»¥æ€»ç»“)</p>
<p>æ ¸å¿ƒè§‚ç‚¹å°±æ˜¯Always make sure that the distribution of the data is same or close to similar before and after the imputation.</p>
<p>ä»¥Titanicçš„Ageä¸ºä¾‹ï¼Œç¬¬ä¸€ç§æ–¹æ³•ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ï¼Œå°±æ˜¯æŠŠç¼ºå¤±å€¼è½¬æ¢æˆå‡å€¼æˆ–è€…ä¸­ä½æ•°ï¼Œä½†è¿™æ˜¾ç„¶ä¼šæ”¹å˜åŸå§‹åˆ†å¸ƒï¼Œæ¯•ç«ŸæŸä¸€ä¸ªå€¼ä¼šå¤ªçªå‡º</p>
<p>ç¬¬äºŒç§æ–¹æ³•ï¼Œè·å¾—Ageçš„å‡å€¼ä¸æ–¹å·®ï¼Œç„¶åç”¨np.random.randint(low_range_train,high_range_train,size_train)ç”Ÿæˆæ•°æ®(low_range_high=mean-std,high_range_train=mean+std)ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•ä»ç„¶ä¼šæ”¹å˜åŸå§‹åˆ†å¸ƒ</p>
<p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ï¼Œç›´æ¥åœ¨åŸå§‹æ•°æ®é‡ŒéšæœºæŠ½æ ·ï¼Œæ•ˆæœæ˜¯æœ€å¥½çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train[<span class="string">&quot;Age_imputed&quot;</span>][train[<span class="string">&quot;Age_imputed&quot;</span>].isna()] = random.sample(<span class="built_in">list</span>(train[<span class="string">&quot;Age&quot;</span>][~(train[<span class="string">&quot;Age&quot;</span>].isna())].values), <span class="built_in">len</span>(train[<span class="string">&quot;Age&quot;</span>][train[<span class="string">&quot;Age&quot;</span>].isna()]))</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯é’ˆå¯¹åˆ†ç±»å˜é‡ï¼Œæœ€å¸¸ç”¨çš„è¿˜æ˜¯one-hotç¼–ç ï¼Œä½†æ³¨æ„åˆ°one-hotç¼–ç ä¼šä½¿å¾—ç‰¹å¾å˜å¾—éå¸¸å¤šï¼Œå¯¹ä¸€ä¸ªnä¸ªå–å€¼ç‰¹å¾è¿›è¡Œone-hotç¼–ç ï¼Œå°±ä¼šå˜æˆnåˆ—ï¼Œæ‰€ä»¥è®¡ç®—é‡æ˜¯éå¸¸å¤§çš„ï¼Œå°±ä¸è¦ä¸€è‚¡è„‘å…¨ç”¨ä¸Šã€‚è¿˜æœ‰æ‰€è°“çš„Ordinal Encodingç¼–ç ï¼Œå°±æ˜¯ä¸åŒç‰¹å¾ç¼–ç 12345ï¼Œè¿™å°±ä¼šæ¶‰åŠåˆ°ä¸€ä¸ªç‰¹å¾å–å€¼æ˜¯å¦å¯æ¯”è¾ƒçš„é—®é¢˜ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">advanced_preprocess_categorical_columns</span>(<span class="params">df, encoding=<span class="string">&#x27;onehot&#x27;</span>, ordinal_columns=<span class="literal">None</span>, rare_threshold=<span class="number">10</span>, unknown_categories=<span class="string">&#x27;Other&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Takes a Pandas DataFrame and performs advanced preprocessing on all categorical columns.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Fills missing values with the mode, removes rare categories, and encodes the data using one-hot encoding or ordinal encoding.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        df: Pandas DataFrame</span></span><br><span class="line"><span class="string">        encoding: encoding method to use (&#x27;onehot&#x27; or &#x27;ordinal&#x27;)</span></span><br><span class="line"><span class="string">        ordinal_columns: dictionary of ordinal columns and their corresponding categories (e.g., &#123;&#x27;column_name&#x27;: [&#x27;low&#x27;, &#x27;medium&#x27;, &#x27;high&#x27;]&#125;)</span></span><br><span class="line"><span class="string">        rare_threshold: threshold for removing rare categories (default is 10)</span></span><br><span class="line"><span class="string">        unknown_categories: label for unknown categories (default is &#x27;Other&#x27;)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        modified DataFrame</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Make a copy of the DataFrame to avoid modifying the original data</span></span><br><span class="line">    df = df.copy()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Get a list of all categorical columns</span></span><br><span class="line">    categorical_columns = df.select_dtypes(include=[<span class="string">&#x27;object&#x27;</span>]).columns</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Fill missing values with the mode</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> categorical_columns:</span><br><span class="line">        df[col] = df[col].fillna(df[col].mode()[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># Remove rare categories</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> categorical_columns:</span><br><span class="line">        <span class="comment"># Get the counts of each category</span></span><br><span class="line">        counts = df[col].value_counts()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Remove categories with less than rare_threshold occurrences</span></span><br><span class="line">        df[col] = df[col].apply(<span class="keyword">lambda</span> x: x <span class="keyword">if</span> counts[x] &gt;= rare_threshold <span class="keyword">else</span> unknown_categories)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> encoding == <span class="string">&#x27;onehot&#x27;</span>:</span><br><span class="line">        <span class="comment"># Encode the data using one-hot encoding</span></span><br><span class="line">        df = pd.get_dummies(df, columns=categorical_columns, drop_first=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">elif</span> encoding == <span class="string">&#x27;ordinal&#x27;</span>:</span><br><span class="line">        <span class="comment"># Check if ordinal_columns is provided</span></span><br><span class="line">        <span class="keyword">if</span> ordinal_columns <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;ordinal_columns must be provided when using ordinal encoding.&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># Encode the data using ordinal encoding</span></span><br><span class="line">        <span class="keyword">for</span> col, categories <span class="keyword">in</span> ordinal_columns.items():</span><br><span class="line">            df[col] = df[col].astype(<span class="string">&#x27;category&#x27;</span>, categories=categories, ordered=<span class="literal">True</span>)</span><br><span class="line">            df[col] = df[col].cat.codes</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Invalid encoding method. Must be &#x27;onehot&#x27; or &#x27;ordinal&#x27;.&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Advanced preprocessing steps completed: filled missing values, removed rare categories, and encoded data.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ç‰¹å¾å·¥ç¨‹ï¼ˆå‚è€ƒLearn-Feature-Engineering-Tutorials-kaggle-com-ï¼‰"><a href="#ç‰¹å¾å·¥ç¨‹ï¼ˆå‚è€ƒLearn-Feature-Engineering-Tutorials-kaggle-com-ï¼‰" class="headerlink" title="ç‰¹å¾å·¥ç¨‹ï¼ˆå‚è€ƒLearn Feature Engineering Tutorials (kaggle.com)ï¼‰"></a>ç‰¹å¾å·¥ç¨‹ï¼ˆå‚è€ƒ<a target="_blank" rel="noopener" href="https://www.kaggle.com/learn/feature-engineering">Learn Feature Engineering Tutorials (kaggle.com)</a>ï¼‰</h2><h4 id="ä»€ä¹ˆæ˜¯ç‰¹å¾å·¥ç¨‹"><a href="#ä»€ä¹ˆæ˜¯ç‰¹å¾å·¥ç¨‹" class="headerlink" title="ä»€ä¹ˆæ˜¯ç‰¹å¾å·¥ç¨‹"></a>ä»€ä¹ˆæ˜¯ç‰¹å¾å·¥ç¨‹</h4><p>ä¸€èˆ¬æ¥è¯´ä¸€ä¸ªæ•°æ®é›†å¯èƒ½æœ‰å¾ˆå¤šç‰¹å¾ï¼Œä½ éœ€è¦ä»ä¸­é€‰æ‹©ä¸€éƒ¨åˆ†é‡è¦çš„ç‰¹å¾æ¥åšï¼Œè¿™æ ·çš„å¥½å¤„åœ¨äº1æå‡æ¨¡å‹æ€§èƒ½2é™ä½è®¡ç®—æˆæœ¬3æé«˜å¯è§£é‡Šæ€§ã€‚</p>
<h3 id="ç‰¹å¾æ•ˆç”¨æŒ‡æ ‡"><a href="#ç‰¹å¾æ•ˆç”¨æŒ‡æ ‡" class="headerlink" title="ç‰¹å¾æ•ˆç”¨æŒ‡æ ‡"></a>ç‰¹å¾æ•ˆç”¨æŒ‡æ ‡</h3><p>é€‰æ‹©åˆé€‚çš„ç‰¹å¾ï¼Œè¿™é‡Œçš„é€‰æ‹©æ˜¯äº’ä¿¡æ¯ï¼Œå¥½å¤„å¦‚ä¸‹ï¼š</p>
<ul>
<li>easy to use and interpret,</li>
<li>computationally efficient,</li>
<li>theoretically well-founded,</li>
<li>resistant to overfitting, and,</li>
<li>able to detect any kind of relationship</li>
</ul>
<p>åŸºæœ¬ä¸Šäº’ä¿¡æ¯å€¼è¶Šå¤§ï¼Œå®ƒå¯¹targetçš„è§£é‡Šå°±è¶Šå¤šï¼Œä¹Ÿå°±ç®—æ˜¯è¶Šå¥½çš„ç‰¹å¾ã€‚</p>
<p>ä½†ä¹Ÿæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li><p>MI can help you to understand the <em>relative potential</em> of a feature as a predictor of the target, considered by itself.</p>
</li>
<li><p>Itâ€™s possible for a feature to be very informative when interacting with other features, but not so informative all alone. MI <em>canâ€™t detect interactions</em> between features. It is a <strong>univariate</strong> metric.</p>
</li>
<li><p>The <em>actual</em> usefulness of a feature <em>depends on the model you use it with</em>. A feature is only useful to the extent that its relationship with the target is one your model can learn. Just because a feature has a high MI score doesnâ€™t mean your model will be able to do anything with that information. You may need to transform the feature first to expose the association.</p>
</li>
</ul>
<p>  å…·ä½“å‡½æ•°åœ¨è¿™é‡Œï¼Œç®—æ˜¯ä¸€ç§ç®€æ´ç­›é€‰ç‰¹å¾çš„æ‰‹æ®µï¼Œå½“ç„¶ä¹Ÿè¦æ³¨æ„åˆ°ä¸Šé¢çš„äº‹é¡¹ã€‚</p>
<ul>
<li>Scikit-learn has two mutual information metrics in its <code>feature_selection</code> module: one for real-valued targets (<code>mutual_info_regression</code>) and one for categorical targets (<code>mutual_info_classif</code>). Our target, <code>price</code>, is real-valued. The next cell computes the MI scores for our features and wraps them up in a nice dataframe.</li>
</ul>
<h3 id="å‘ç°æ–°çš„ç‰¹å¾"><a href="#å‘ç°æ–°çš„ç‰¹å¾" class="headerlink" title="å‘ç°æ–°çš„ç‰¹å¾"></a>å‘ç°æ–°çš„ç‰¹å¾</h3><p>å‘ç°æ–°ç‰¹å¾çš„Tips</p>
<ul>
<li>Understand the features. Refer to your datasetâ€™s <em>data documentation</em>, if available.</li>
<li>Research the problem domain to acquire <strong>domain knowledge</strong>. If your problem is predicting house prices, do some research on real-estate for instance. Wikipedia can be a good starting point, but books and <a target="_blank" rel="noopener" href="https://scholar.google.com/">journal articles</a> will often have the best information.</li>
<li>Study previous work. <a target="_blank" rel="noopener" href="https://www.kaggle.com/sudalairajkumar/winning-solutions-of-kaggle-competitions">Solution write-ups</a> from past Kaggle competitions are a great resource.</li>
<li>Use data visualization. Visualization can reveal pathologies in the distribution of a feature or complicated relationships that could be simplified. Be sure to visualize your dataset as you work through the feature engineering process.</li>
</ul>
<h4 id="Mathematical-Transformsï¼šå¯¹ç‰¹å¾è¿›è¡Œç®€å•çš„åŠ å‡ä¹˜é™¤ç»„åˆï¼Œä¸€èˆ¬æ¥è¯´é€šè¿‡æ•°æ®å¯è§†åŒ–æ¥è°ƒæ•´ç»„åˆ"><a href="#Mathematical-Transformsï¼šå¯¹ç‰¹å¾è¿›è¡Œç®€å•çš„åŠ å‡ä¹˜é™¤ç»„åˆï¼Œä¸€èˆ¬æ¥è¯´é€šè¿‡æ•°æ®å¯è§†åŒ–æ¥è°ƒæ•´ç»„åˆ" class="headerlink" title="Mathematical Transformsï¼šå¯¹ç‰¹å¾è¿›è¡Œç®€å•çš„åŠ å‡ä¹˜é™¤ç»„åˆï¼Œä¸€èˆ¬æ¥è¯´é€šè¿‡æ•°æ®å¯è§†åŒ–æ¥è°ƒæ•´ç»„åˆ"></a>Mathematical Transformsï¼šå¯¹ç‰¹å¾è¿›è¡Œç®€å•çš„åŠ å‡ä¹˜é™¤ç»„åˆï¼Œä¸€èˆ¬æ¥è¯´é€šè¿‡æ•°æ®å¯è§†åŒ–æ¥è°ƒæ•´ç»„åˆ</h4><h3 id="Counts-Features-describing-the-presence-or-absence-of-something-often-come-in-sets-the-set-of-risk-factors-for-a-disease-say-You-can-aggregate-such-features-by-creating-a-count"><a href="#Counts-Features-describing-the-presence-or-absence-of-something-often-come-in-sets-the-set-of-risk-factors-for-a-disease-say-You-can-aggregate-such-features-by-creating-a-count" class="headerlink" title="Counts: Features describing the presence or absence of something often come in sets, the set of risk factors for a disease, say. You can aggregate such features by creating a count."></a>Counts: Features describing the presence or absence of something often come in sets, the set of risk factors for a disease, say. You can aggregate such features by creating a <strong>count</strong>.</h3><h3 id="Building-Up-and-Breaking-Down-Features-æ¯”å¦‚èº«ä»½è¯å‰å…­ä½æ˜¯åœ°å€ä»€ä¹ˆçš„"><a href="#Building-Up-and-Breaking-Down-Features-æ¯”å¦‚èº«ä»½è¯å‰å…­ä½æ˜¯åœ°å€ä»€ä¹ˆçš„" class="headerlink" title="Building-Up and Breaking-Down Features: æ¯”å¦‚èº«ä»½è¯å‰å…­ä½æ˜¯åœ°å€ä»€ä¹ˆçš„"></a>Building-Up and Breaking-Down Features: æ¯”å¦‚èº«ä»½è¯å‰å…­ä½æ˜¯åœ°å€ä»€ä¹ˆçš„</h3><ul>
<li>D numbers: <code>&#39;123-45-6789&#39;</code></li>
<li>Phone numbers: <code>&#39;(999) 555-0123&#39;</code></li>
<li>Street addresses: <code>&#39;8241 Kaggle Ln., Goose City, NV&#39;</code></li>
<li>Internet addresses: <code>&#39;http://www.kaggle.com</code></li>
<li>Product codes: <code>&#39;0 36000 29145 2&#39;</code></li>
<li>Dates and times: <code>&#39;Mon Sep 30 07:06:05 2013&#39;</code></li>
</ul>
<h3 id="Group-Transformation-Using-an-aggregation-function-a-group-transform-combines-two-features-a-categorical-feature-that-provides-the-grouping-and-another-feature-whose-values-you-wish-to-aggregate"><a href="#Group-Transformation-Using-an-aggregation-function-a-group-transform-combines-two-features-a-categorical-feature-that-provides-the-grouping-and-another-feature-whose-values-you-wish-to-aggregate" class="headerlink" title="Group Transformation: Using an aggregation function, a group transform combines two features: a categorical feature that provides the grouping and another feature whose values you wish to aggregate"></a>Group Transformation: Using an aggregation function, a group transform combines two features: a categorical feature that provides the grouping and another feature whose values you wish to aggregate</h3><p><strong>Tips on Creating Features</strong><br>Itâ€™s good to keep in mind your modelâ€™s own strengths and weaknesses when creating features. Here are some guidelines:</p>
<ul>
<li>Linear models learn sums and differences naturally, but canâ€™t learn anything more complex.</li>
<li>Ratios seem to be difficult for most models to learn. Ratio combinations often lead to some easy performance gains.</li>
<li>Linear models and neural nets generally do better with normalized features. Neural nets especially need features scaled to values not too far from 0. Tree-based models (like random forests and XGBoost) can sometimes benefit from normalization, but usually much less so.</li>
<li>Tree models can learn to approximate almost any combination of features, but when a combination is especially important they can still benefit from having it explicitly created, especially when data is limited.</li>
<li>Counts are especially helpful for tree models, since these models donâ€™t have a natural way of aggregating information across many features at once.</li>
</ul>
<h3 id="å°†èšç±»æ ‡ç­¾ä½œä¸ºç‰¹å¾"><a href="#å°†èšç±»æ ‡ç­¾ä½œä¸ºç‰¹å¾" class="headerlink" title="å°†èšç±»æ ‡ç­¾ä½œä¸ºç‰¹å¾"></a>å°†èšç±»æ ‡ç­¾ä½œä¸ºç‰¹å¾</h3><p>The motivating idea for adding cluster labels is that the clusters will break up complicated relationships across features into simpler chunks. Our model can then just learn the simpler chunks one-by-one instead having to learn the complicated whole all at once. Itâ€™s a â€œdivide and conquerâ€ strategy.ä½†æ˜¯Kçš„æ•°ç›®çš„ç¡®å®šå€’æ˜¯æ²¡æœ‰ç»†è¯´ã€‚</p>
<h3 id="PCA"><a href="#PCA" class="headerlink" title="PCA"></a>PCA</h3><p>PCA is a great tool to help you discover important relationships in the data and can also be used to create more informative features.</p>
<p>PCAçš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li><strong>Dimensionality reduction</strong>: When your features are highly redundant (<em>multicollinear</em>, specifically), PCA will partition out the redundancy into one or more near-zero variance components, which you can then drop since they will contain little or no information.</li>
<li><strong>Anomaly detection</strong>: Unusual variation, not apparent from the original features, will often show up in the low-variance components. These components could be highly informative in an anomaly or outlier detection task.</li>
<li><strong>Noise reduction</strong>: A collection of sensor readings will often share some common background noise. PCA can sometimes collect the (informative) signal into a smaller number of features while leaving the noise alone, thus boosting the signal-to-noise ratio.</li>
<li><strong>Decorrelation</strong>: Some ML algorithms struggle with highly-correlated features. PCA transforms correlated features into uncorrelated components, which could be easier for your algorithm to work with.</li>
</ul>
<p><strong>PCA Best Practices</strong><br>There are a few things to keep in mind when applying PCA:</p>
<ul>
<li>PCA only works with numeric features, like continuous quantities or counts.</li>
<li>PCA is sensitive to scale. Itâ€™s good practice to standardize your data before applying PCA, unless you know you have good reason not to.</li>
<li>Consider removing or constraining outliers, since they can have an undue influence on the results.</li>
</ul>
<h3 id="Target-Encodingï¼ˆé’ˆå¯¹åˆ†ç±»å˜é‡ï¼‰"><a href="#Target-Encodingï¼ˆé’ˆå¯¹åˆ†ç±»å˜é‡ï¼‰" class="headerlink" title="Target Encodingï¼ˆé’ˆå¯¹åˆ†ç±»å˜é‡ï¼‰"></a>Target Encodingï¼ˆé’ˆå¯¹åˆ†ç±»å˜é‡ï¼‰</h3><h1 id="Smoothing"><a href="#Smoothing" class="headerlink" title="Smoothing"></a>Smoothing</h1><p>An encoding like this presents a couple of problems, however. First are <em>unknown categories</em>. Target encodings create a special risk of overfitting, which means they need to be trained on an independent â€œencodingâ€ split. When you join the encoding to future splits, Pandas will fill in missing values for any categories not present in the encoding split. These missing values you would have to impute somehow.</p>
<p>Second are <em>rare categories</em>. When a category only occurs a few times in the dataset, any statistics calculated on its group are unlikely to be very accurate. In the <em>Automobiles</em> dataset, the <code>mercurcy</code> make only occurs once. The â€œmeanâ€ price we calculated is just the price of that one vehicle, which might not be very representative of any Mercuries we might see in the future. Target encoding rare categories can make overfitting more likely.</p>
<p>A solution to these problems is to add <strong>smoothing</strong>. The idea is to blend the <em>in-category</em> average with the <em>overall</em> average. Rare categories get less weight on their category average, while missing categories just get the overall average.</p>
<p><strong>Use Cases for Target Encoding</strong><br>Target encoding is great for:</p>
<ul>
<li><strong>High-cardinality features</strong>: A feature with a large number of categories can be troublesome to encode: a one-hot encoding would generate too many features and alternatives, like a label encoding, might not be appropriate for that feature. A target encoding derives numbers for the categories using the featureâ€™s most important property: its relationship with the target.</li>
<li><strong>Domain-motivated features</strong>: From prior experience, you might suspect that a categorical feature should be important even if it scored poorly with a feature metric. A target encoding can help reveal a featureâ€™s true informativeness.</li>
</ul>
<h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.compose <span class="keyword">import</span> ColumnTransformer</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.impute <span class="keyword">import</span> SimpleImputer</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"></span><br><span class="line"><span class="comment"># Preprocessing for numerical data</span></span><br><span class="line">numerical_transformer = SimpleImputer(strategy=<span class="string">&#x27;constant&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Preprocessing for categorical data</span></span><br><span class="line">categorical_transformer = Pipeline(steps=[</span><br><span class="line">    (<span class="string">&#x27;imputer&#x27;</span>, SimpleImputer(strategy=<span class="string">&#x27;most_frequent&#x27;</span>)),</span><br><span class="line">    (<span class="string">&#x27;onehot&#x27;</span>, OneHotEncoder(handle_unknown=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bundle preprocessing for numerical and categorical data</span></span><br><span class="line">preprocessor = ColumnTransformer(</span><br><span class="line">    transformers=[</span><br><span class="line">        (<span class="string">&#x27;num&#x27;</span>, numerical_transformer, numerical_cols),</span><br><span class="line">        (<span class="string">&#x27;cat&#x27;</span>, categorical_transformer, categorical_cols)</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"></span><br><span class="line">model = RandomForestRegressor(n_estimators=<span class="number">100</span>, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bundle preprocessing and modeling code in a pipeline</span></span><br><span class="line">my_pipeline = Pipeline(steps=[(<span class="string">&#x27;preprocessor&#x27;</span>, preprocessor),</span><br><span class="line">                              (<span class="string">&#x27;model&#x27;</span>, model)</span><br><span class="line">                             ])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Preprocessing of training data, fit model </span></span><br><span class="line">my_pipeline.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Preprocessing of validation data, get predictions</span></span><br><span class="line">preds = my_pipeline.predict(X_valid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Evaluate the model</span></span><br><span class="line">score = mean_absolute_error(y_valid, preds)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;MAE:&#x27;</span>, score)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/kaggle/" rel="tag"># kaggle</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/12/31/%E5%81%A5%E8%BA%AB/" rel="prev" title="å¥èº«">
                  <i class="fa fa-chevron-left"></i> å¥èº«
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/01/03/leetcode/" rel="next" title="leetcode">
                  leetcode <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
